const data=[
  {
    "": 0,
    "rallyid": 1,
    "server": "Djokovic",
    "x": 1.86,
    "y": 16.8
  },
  {
    "": 1,
    "rallyid": 3,
    "server": "Djokovic",
    "x": 7.05,
    "y": 16.97
  },
  {
    "": 2,
    "rallyid": 6,
    "server": "Djokovic",
    "x": 8.04,
    "y": 17.8
  },
  {
    "": 3,
    "rallyid": 8,
    "server": "Nadal",
    "x": 4.44,
    "y": 16.24
  },
  {
    "": 4,
    "rallyid": 9,
    "server": "Nadal",
    "x": 5.71,
    "y": 16.4
  },
  {
    "": 5,
    "rallyid": 11,
    "server": "Nadal",
    "x": 4.66,
    "y": 16.24
  },
  {
    "": 6,
    "rallyid": 13,
    "server": "Nadal",
    "x": 5.83,
    "y": 16.72
  },
  {
    "": 7,
    "rallyid": 14,
    "server": "Nadal",
    "x": 0.98,
    "y": 17.3
  },
  {
    "": 8,
    "rallyid": 15,
    "server": "Djokovic",
    "x": 5.58,
    "y": 5.41
  },
  {
    "": 9,
    "rallyid": 17,
    "server": "Djokovic",
    "x": 3.87,
    "y": 10.83
  },
  {
    "": 10,
    "rallyid": 18,
    "server": "Djokovic",
    "x": 5.14,
    "y": 6.51
  },
  {
    "": 11,
    "rallyid": 20,
    "server": "Nadal",
    "x": 6.68,
    "y": 4.64
  },
  {
    "": 12,
    "rallyid": 22,
    "server": "Nadal",
    "x": 2.77,
    "y": 6.71
  },
  {
    "": 13,
    "rallyid": 23,
    "server": "Nadal",
    "x": 4.27,
    "y": 6.51
  },
  {
    "": 14,
    "rallyid": 24,
    "server": "Nadal",
    "x": 7.55,
    "y": 6.66
  },
  {
    "": 15,
    "rallyid": 25,
    "server": "Nadal",
    "x": 1.01,
    "y": 7.63
  },
  {
    "": 16,
    "rallyid": 26,
    "server": "Nadal",
    "x": 5.03,
    "y": 6.32
  },
  {
    "": 17,
    "rallyid": 28,
    "server": "Nadal",
    "x": 3.07,
    "y": 6.41
  },
  {
    "": 18,
    "rallyid": 29,
    "server": "Nadal",
    "x": 7.98,
    "y": 5.93
  },
  {
    "": 19,
    "rallyid": 30,
    "server": "Nadal",
    "x": 1.16,
    "y": 7.9
  },
  {
    "": 20,
    "rallyid": 32,
    "server": "Djokovic",
    "x": 4.53,
    "y": 17.89
  },
  {
    "": 21,
    "rallyid": 34,
    "server": "Djokovic",
    "x": 7.15,
    "y": 17.46
  },
  {
    "": 22,
    "rallyid": 36,
    "server": "Nadal",
    "x": 3.19,
    "y": 16.16
  },
  {
    "": 23,
    "rallyid": 37,
    "server": "Nadal",
    "x": 8.4,
    "y": 16.16
  },
  {
    "": 24,
    "rallyid": 38,
    "server": "Nadal",
    "x": 4.53,
    "y": 15.92
  },
  {
    "": 25,
    "rallyid": 40,
    "server": "Nadal",
    "x": 5.88,
    "y": 16.48
  },
  {
    "": 26,
    "rallyid": 42,
    "server": "Nadal",
    "x": 3.68,
    "y": 16.56
  },
  {
    "": 27,
    "rallyid": 43,
    "server": "Nadal",
    "x": 7.76,
    "y": 16
  },
  {
    "": 28,
    "rallyid": 44,
    "server": "Djokovic",
    "x": 8.23,
    "y": 6.96
  },
  {
    "": 29,
    "rallyid": 46,
    "server": "Djokovic",
    "x": 2.61,
    "y": 11.58
  },
  {
    "": 30,
    "rallyid": 48,
    "server": "Djokovic",
    "x": 5.31,
    "y": 5.79
  },
  {
    "": 31,
    "rallyid": 49,
    "server": "Djokovic",
    "x": 1.86,
    "y": 8.77
  },
  {
    "": 32,
    "rallyid": 51,
    "server": "Nadal",
    "x": 7.08,
    "y": 6.81
  },
  {
    "": 33,
    "rallyid": 54,
    "server": "Nadal",
    "x": 1.83,
    "y": 8
  },
  {
    "": 34,
    "rallyid": 56,
    "server": "Nadal",
    "x": 5.3,
    "y": 6.36
  },
  {
    "": 35,
    "rallyid": 57,
    "server": "Nadal",
    "x": 4.13,
    "y": 7.48
  },
  {
    "": 36,
    "rallyid": 59,
    "server": "Djokovic",
    "x": 1.4,
    "y": 16.64
  },
  {
    "": 37,
    "rallyid": 60,
    "server": "Djokovic",
    "x": 4.74,
    "y": 15.53
  },
  {
    "": 38,
    "rallyid": 62,
    "server": "Djokovic",
    "x": 1.68,
    "y": 16.32
  },
  {
    "": 39,
    "rallyid": 63,
    "server": "Djokovic",
    "x": 5.08,
    "y": 16.8
  },
  {
    "": 40,
    "rallyid": 64,
    "server": "Djokovic",
    "x": 0.86,
    "y": 16
  },
  {
    "": 41,
    "rallyid": 65,
    "server": "Nadal",
    "x": 1.63,
    "y": 16.26
  },
  {
    "": 42,
    "rallyid": 66,
    "server": "Nadal",
    "x": 8.69,
    "y": 17.43
  },
  {
    "": 43,
    "rallyid": 67,
    "server": "Nadal",
    "x": 4.63,
    "y": 17.09
  },
  {
    "": 44,
    "rallyid": 70,
    "server": "Nadal",
    "x": 7.35,
    "y": 16.26
  },
  {
    "": 45,
    "rallyid": 71,
    "server": "Nadal",
    "x": 4.91,
    "y": 15.54
  },
  {
    "": 46,
    "rallyid": 73,
    "server": "Nadal",
    "x": 8.08,
    "y": 15.54
  },
  {
    "": 47,
    "rallyid": 75,
    "server": "Djokovic",
    "x": 2.05,
    "y": 16.84
  },
  {
    "": 48,
    "rallyid": 77,
    "server": "Djokovic",
    "x": 6.16,
    "y": 15.85
  },
  {
    "": 49,
    "rallyid": 78,
    "server": "Djokovic",
    "x": 3.93,
    "y": 16.26
  },
  {
    "": 50,
    "rallyid": 79,
    "server": "Djokovic",
    "x": 5.13,
    "y": 16.67
  },
  {
    "": 51,
    "rallyid": 80,
    "server": "Nadal",
    "x": 5.24,
    "y": 6.79
  },
  {
    "": 52,
    "rallyid": 82,
    "server": "Nadal",
    "x": 7.76,
    "y": 6.49
  },
  {
    "": 53,
    "rallyid": 84,
    "server": "Nadal",
    "x": 3.14,
    "y": 7.48
  },
  {
    "": 54,
    "rallyid": 86,
    "server": "Nadal",
    "x": 7.34,
    "y": 6.44
  },
  {
    "": 55,
    "rallyid": 87,
    "server": "Nadal",
    "x": 1.6,
    "y": 7.91
  },
  {
    "": 56,
    "rallyid": 89,
    "server": "Djokovic",
    "x": 5.9,
    "y": 5.94
  },
  {
    "": 57,
    "rallyid": 91,
    "server": "Djokovic",
    "x": 2.89,
    "y": 9.56
  },
  {
    "": 58,
    "rallyid": 92,
    "server": "Djokovic",
    "x": 5,
    "y": 5.94
  },
  {
    "": 59,
    "rallyid": 93,
    "server": "Djokovic",
    "x": 4.92,
    "y": 10.41
  },
  {
    "": 60,
    "rallyid": 94,
    "server": "Djokovic",
    "x": 4.65,
    "y": 6.85
  },
  {
    "": 61,
    "rallyid": 96,
    "server": "Nadal",
    "x": 3.95,
    "y": 17.35
  },
  {
    "": 62,
    "rallyid": 97,
    "server": "Nadal",
    "x": 8.08,
    "y": 17.01
  },
  {
    "": 63,
    "rallyid": 98,
    "server": "Nadal",
    "x": 1.46,
    "y": 16.18
  },
  {
    "": 64,
    "rallyid": 99,
    "server": "Nadal",
    "x": 7.63,
    "y": 16.01
  },
  {
    "": 65,
    "rallyid": 100,
    "server": "Nadal",
    "x": 4.37,
    "y": 16.01
  },
  {
    "": 66,
    "rallyid": 103,
    "server": "Djokovic",
    "x": 1.24,
    "y": 16.76
  },
  {
    "": 67,
    "rallyid": 104,
    "server": "Djokovic",
    "x": 8.25,
    "y": 16.67
  },
  {
    "": 68,
    "rallyid": 105,
    "server": "Djokovic",
    "x": 1.24,
    "y": 16.18
  },
  {
    "": 69,
    "rallyid": 108,
    "server": "Djokovic",
    "x": 5.42,
    "y": 16.51
  },
  {
    "": 70,
    "rallyid": 109,
    "server": "Djokovic",
    "x": 0.93,
    "y": 15.94
  },
  {
    "": 71,
    "rallyid": 110,
    "server": "Djokovic",
    "x": 4.94,
    "y": 16.1
  },
  {
    "": 72,
    "rallyid": 111,
    "server": "Djokovic",
    "x": 1.63,
    "y": 17.52
  },
  {
    "": 73,
    "rallyid": 112,
    "server": "Djokovic",
    "x": 5.2,
    "y": 16.59
  },
  {
    "": 74,
    "rallyid": 114,
    "server": "Djokovic",
    "x": 1.4,
    "y": 15.77
  },
  {
    "": 75,
    "rallyid": 115,
    "server": "Djokovic",
    "x": 4.86,
    "y": 15.46
  },
  {
    "": 76,
    "rallyid": 117,
    "server": "Nadal",
    "x": 7.45,
    "y": 6.54
  },
  {
    "": 77,
    "rallyid": 120,
    "server": "Nadal",
    "x": 7.71,
    "y": 7
  },
  {
    "": 78,
    "rallyid": 122,
    "server": "Nadal",
    "x": 4.86,
    "y": 6.49
  },
  {
    "": 79,
    "rallyid": 123,
    "server": "Nadal",
    "x": 5.65,
    "y": 5.89
  },
  {
    "": 80,
    "rallyid": 126,
    "server": "Djokovic",
    "x": 1.79,
    "y": 8.97
  },
  {
    "": 81,
    "rallyid": 127,
    "server": "Djokovic",
    "x": 4.54,
    "y": 7.96
  },
  {
    "": 82,
    "rallyid": 128,
    "server": "Djokovic",
    "x": 1.46,
    "y": 8.41
  },
  {
    "": 83,
    "rallyid": 130,
    "server": "Nadal",
    "x": 4.38,
    "y": 17.18
  },
  {
    "": 84,
    "rallyid": 131,
    "server": "Nadal",
    "x": 7.73,
    "y": 16.1
  },
  {
    "": 85,
    "rallyid": 132,
    "server": "Nadal",
    "x": 0.89,
    "y": 17.09
  },
  {
    "": 86,
    "rallyid": 134,
    "server": "Nadal",
    "x": 7.25,
    "y": 16.1
  },
  {
    "": 87,
    "rallyid": 135,
    "server": "Nadal",
    "x": 3.67,
    "y": 16.76
  },
  {
    "": 88,
    "rallyid": 136,
    "server": "Nadal",
    "x": 8.57,
    "y": 16.67
  },
  {
    "": 89,
    "rallyid": 139,
    "server": "Djokovic",
    "x": 2.74,
    "y": 17.52
  },
  {
    "": 90,
    "rallyid": 141,
    "server": "Djokovic",
    "x": 5.51,
    "y": 17.35
  },
  {
    "": 91,
    "rallyid": 143,
    "server": "Djokovic",
    "x": 4.19,
    "y": 16.51
  },
  {
    "": 92,
    "rallyid": 146,
    "server": "Djokovic",
    "x": 8.41,
    "y": 17.26
  },
  {
    "": 93,
    "rallyid": 147,
    "server": "Nadal",
    "x": 5.04,
    "y": 5.22
  },
  {
    "": 94,
    "rallyid": 149,
    "server": "Nadal",
    "x": 4.78,
    "y": 4.26
  },
  {
    "": 95,
    "rallyid": 152,
    "server": "Nadal",
    "x": 2.13,
    "y": 7.91
  },
  {
    "": 96,
    "rallyid": 154,
    "server": "Nadal",
    "x": 6.25,
    "y": 6.34
  },
  {
    "": 97,
    "rallyid": 155,
    "server": "Nadal",
    "x": 1.74,
    "y": 7.05
  },
  {
    "": 98,
    "rallyid": 156,
    "server": "Djokovic",
    "x": 8.19,
    "y": 6.79
  },
  {
    "": 99,
    "rallyid": 157,
    "server": "Djokovic",
    "x": 2.04,
    "y": 10.23
  },
  {
    "": 100,
    "rallyid": 158,
    "server": "Djokovic",
    "x": 8.2,
    "y": 8.13
  },
  {
    "": 101,
    "rallyid": 161,
    "server": "Djokovic",
    "x": 8.14,
    "y": 6.14
  },
  {
    "": 102,
    "rallyid": 162,
    "server": "Nadal",
    "x": 4,
    "y": 17.52
  },
  {
    "": 103,
    "rallyid": 163,
    "server": "Nadal",
    "x": 8.46,
    "y": 16.67
  },
  {
    "": 104,
    "rallyid": 164,
    "server": "Nadal",
    "x": 1.27,
    "y": 16.42
  },
  {
    "": 105,
    "rallyid": 168,
    "server": "Nadal",
    "x": 0.97,
    "y": 17.18
  },
  {
    "": 106,
    "rallyid": 169,
    "server": "Djokovic",
    "x": 3.5,
    "y": 17.87
  },
  {
    "": 107,
    "rallyid": 170,
    "server": "Djokovic",
    "x": 4.91,
    "y": 16.92
  },
  {
    "": 108,
    "rallyid": 171,
    "server": "Djokovic",
    "x": 0.95,
    "y": 16.84
  },
  {
    "": 109,
    "rallyid": 173,
    "server": "Djokovic",
    "x": 5.28,
    "y": 16.1
  },
  {
    "": 110,
    "rallyid": 174,
    "server": "Djokovic",
    "x": 1.3,
    "y": 16.26
  },
  {
    "": 111,
    "rallyid": 175,
    "server": "Djokovic",
    "x": 5.07,
    "y": 16.76
  },
  {
    "": 112,
    "rallyid": 176,
    "server": "Djokovic",
    "x": 1.05,
    "y": 15.3
  },
  {
    "": 113,
    "rallyid": 178,
    "server": "Djokovic",
    "x": 8.07,
    "y": 17.18
  },
  {
    "": 114,
    "rallyid": 179,
    "server": "Nadal",
    "x": 6.08,
    "y": 6.19
  },
  {
    "": 115,
    "rallyid": 180,
    "server": "Nadal",
    "x": 4.64,
    "y": 7.42
  },
  {
    "": 116,
    "rallyid": 182,
    "server": "Nadal",
    "x": 7.9,
    "y": 6.95
  },
  {
    "": 117,
    "rallyid": 183,
    "server": "Nadal",
    "x": 4.58,
    "y": 7
  },
  {
    "": 118,
    "rallyid": 186,
    "server": "Nadal",
    "x": 5.6,
    "y": 7.42
  },
  {
    "": 119,
    "rallyid": 188,
    "server": "Djokovic",
    "x": 7.69,
    "y": 7.11
  },
  {
    "": 120,
    "rallyid": 189,
    "server": "Djokovic",
    "x": 4.46,
    "y": 8.55
  },
  {
    "": 121,
    "rallyid": 190,
    "server": "Djokovic",
    "x": 4.65,
    "y": 6.74
  },
  {
    "": 122,
    "rallyid": 191,
    "server": "Djokovic",
    "x": 4.65,
    "y": 8.86
  },
  {
    "": 123,
    "rallyid": 193,
    "server": "Djokovic",
    "x": 4.43,
    "y": 6.95
  },
  {
    "": 124,
    "rallyid": 194,
    "server": "Djokovic",
    "x": 4.82,
    "y": 8.29
  },
  {
    "": 125,
    "rallyid": 195,
    "server": "Djokovic",
    "x": 8.1,
    "y": 7.16
  },
  {
    "": 126,
    "rallyid": 196,
    "server": "Djokovic",
    "x": 6.08,
    "y": 7.85
  },
  {
    "": 127,
    "rallyid": 198,
    "server": "Nadal",
    "x": 4.41,
    "y": 16.42
  },
  {
    "": 128,
    "rallyid": 199,
    "server": "Nadal",
    "x": 5.89,
    "y": 16.42
  },
  {
    "": 129,
    "rallyid": 201,
    "server": "Nadal",
    "x": 2.38,
    "y": 17.43
  },
  {
    "": 130,
    "rallyid": 202,
    "server": "Nadal",
    "x": 8.29,
    "y": 15.88
  },
  {
    "": 131,
    "rallyid": 204,
    "server": "Nadal",
    "x": 3.21,
    "y": 16.24
  },
  {
    "": 132,
    "rallyid": 206,
    "server": "Nadal",
    "x": 6.49,
    "y": 16.64
  }
];


      
const svg = d3.select("#tennis-court");
      
const DjokovicData=[];
const NadalData=[]

const Djokovic1Data=[]
const Djokovic2Data=[]
const Djokovic3Data=[]
const Nadal1Data=[]
const Nadal2Data=[]
const Nadal3Data=[]

data.forEach(item=>{
  if(item.server==="Djokovic"){
    DjokovicData.push(item);
  } else if(item.server==="Nadal"){
    NadalData.push(item);
  }
});

DjokovicData.forEach(item=>{
   if(item.rallyid<=64 && item.rallyid>0){
    Djokovic1Data.push(item);
  }else if(item.rallyid>64 && item.rallyid<=128){
    Djokovic2Data.push(item);
  }else if(item.rallyid>=130 && item.rallyid<=206){
    Djokovic3Data.push(item);
  }
});
NadalData.forEach(item=>{
  if(item.rallyid<=64 && item.rallyid>0){
    Nadal1Data.push(item);
  }else if(item.rallyid>64 && item.rallyid<=128){
    Nadal2Data.push(item);
  }else if(item.rallyid>=130 && item.rallyid<=206){
    Nadal3Data.push(item);
  }
});

const height_court =219.4;
const width_court = 118.9 * 4;
const service_box = 125;
const double_field = 27.4;
const baseline_serviceline = 110;
const breite_einzel = 164.6;
const serviceline_net = 125;

    // Court outline
svg
    .append("rect")
    .attr("x", 0)
    .attr("y", 0)
    .attr("width", height_court)
    .attr("height", width_court)
    .attr("fill", "#5581A6")
    .attr("stroke", "white");
  
  // Net
svg
    .append("line")
    .attr("x1", height_court)
    .attr("y1", width_court / 2)
    .attr("x2", 0)
    .attr("y2", width_court / 2)
    .attr("stroke", "white");
  
  // Serving rectangle
svg
    .append("rect")
    .attr("x", double_field)
    .attr("y", baseline_serviceline)
    .attr("width", breite_einzel)
    .attr("height", serviceline_net * 2)
    .attr("fill", "none")
    .attr("stroke", "white");
  
  // Service lines
svg
    .append("line")
    .attr("x1", height_court / 2)
    .attr("y1", width_court / 2 - service_box)
    .attr("x2", height_court / 2)
    .attr("y2", width_court / 2 + service_box)
    .attr("stroke", "white");

svg
    .append("line")
    .attr("x1", height_court / 2)
    .attr("y1", 0)
    .attr("x2", height_court / 2)
    .attr("y2", 0 + 0.45)
    .attr("stroke", "white");

svg
    .append("line")
    .attr("x1", height_court / 2)
    .attr("y1", width_court)
    .attr("x2", height_court / 2)
    .attr("y2", width_court - 0.45)
    .attr("stroke", "white");

svg
    .append("line")
    .attr("x1", double_field)
    .attr("y1", 0)
    .attr("x2", double_field)
    .attr("y2", width_court)
    .attr("stroke", "white");

svg
    .append("line")
    .attr("x1", height_court - double_field)
    .attr("y1", 0)
    .attr("x2", height_court - double_field)
    .attr("y2", width_court)
    .attr("stroke", "white");


function update(data) {
  // Remove existing tennis balls
  svg.selectAll(".tennis-ball")
  .transition()
  .duration(500)
  .attr("r",0)
  .remove();

  // Draw tennis balls based on the new data
  const tennisBalls = svg.selectAll(".tennis-ball")
    .data(data)
    .enter()
    .append("circle")
    .attr("class", "tennis-ball")
    .attr("cx", d => d.x*20) // x-koordinata iz podataka
    .attr("cy", d => d.y*20) // y-koordinata iz podataka
    .attr("r", 0) // veličina lopte
    .attr("fill", "yellow") // boja lopte
    .attr("stroke", "black") // boja ruba lopte
    .attr("stroke-width", 1) // debljina ruba lopte
    .transition()
    .duration(1000) // Trajanje tranzicije u milisekundama
    .attr("r", 3)
    .attr("fill", d => {
      // Provjeriti uvjet za položaj lopte unutar ili izvan polja za serviranje
      if (
        d.x*20 >= 0 && d.x*20 <= height_court &&
        d.y*20 >= 0 && d.y*20 <= width_court &&
        d.x*20 >= double_field && d.x*20 <= (double_field + breite_einzel) &&
        d.y*20 >= baseline_serviceline && d.y*20 <= (baseline_serviceline + serviceline_net * 2)
        ){
        // Loptica je unutar terena
        // Lopta je unutar polja za serviranje, obojati je žutom bojom
        return "yellow";
      } else {
        // Lopta je izvan polja za serviranje, obojati je crvenom bojom
        return "red";
      }
    });
   
}

// Button click event handlers
function handleButtonClick(buttonId) {
  if (buttonId === "button-djokovic") {
    update(DjokovicData); // Display Djokovic's data
  } else if (buttonId === "button-nadal") {
    update(NadalData); // Display Nadal's data
  }else if (buttonId === "button-djokovic1") {
    update(Djokovic1Data); // Display Nadal's data
  }
  else if (buttonId === "button-djokovic2") {
    update(Djokovic2Data); // Display Nadal's data
  }
  else if (buttonId === "button-djokovic3") {
    update(Djokovic3Data); // Display Nadal's data
  }else if (buttonId === "button-nadal1") {
    update(Nadal1Data); // Display Nadal's data
  }else if (buttonId === "button-nadal2") {
    update(Nadal2Data); // Display Nadal's data
  }else if (buttonId === "button-nadal3") {
    update(Nadal3Data); // Display Nadal's data
  }
  
}

// Add event listeners to the buttons
document.getElementById("button-djokovic").addEventListener("click", () => handleButtonClick("button-djokovic"));
document.getElementById("button-nadal").addEventListener("click", () => handleButtonClick("button-nadal"));
document.getElementById("button-djokovic1").addEventListener("click", () => handleButtonClick("button-djokovic1"));
document.getElementById("button-djokovic2").addEventListener("click", () => handleButtonClick("button-djokovic2"));
document.getElementById("button-djokovic3").addEventListener("click", () => handleButtonClick("button-djokovic3"));
document.getElementById("button-nadal1").addEventListener("click", () => handleButtonClick("button-nadal1"));
document.getElementById("button-nadal2").addEventListener("click", () => handleButtonClick("button-nadal2"));
document.getElementById("button-nadal3").addEventListener("click", () => handleButtonClick("button-nadal3"));



